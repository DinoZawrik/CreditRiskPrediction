# Предсказание кредитного риска с использованием машинного обучения

[![Статус проекта](https://img.shields.io/badge/Статус-Завершен-brightgreen.svg)](https://github.com/yourusername/yourrepository)
[![Лицензия](https://img.shields.io/badge/Лицензия-MIT-blue.svg)](https://opensource.org/licenses/MIT)
[![Версия Python](https://img.shields.io/badge/Python-3.7+-yellow.svg)](https://www.python.org/)
[![Библиотеки](https://img.shields.io/badge/Библиотеки-Pandas%2C%20Scikit--learn%2C%20XGBoost%2C%20CatBoost%2C%20LightGBM-orange.svg)](https://github.com/yourusername/yourrepository)

## Обзор

Этот проект посвящен созданию модели машинного обучения для предсказания кредитного риска, а именно вероятности возникновения серьезной просрочки по кредиту (90 дней и более). Точная оценка кредитного риска критически важна для финансовых учреждений для принятия обоснованных решений о кредитовании и эффективного управления рисками.

В этом проекте используется набор данных "Give Me Some Credit" с Kaggle для обучения и оценки различных моделей классификации.

## Набор данных

*   **Название:** Give Me Some Credit
*   **Источник:** [Kaggle](https://www.kaggle.com/c/GiveMeSomeCredit)
*   **Описание:**  Этот набор данных содержит личную финансовую информацию и данные кредитной истории для большого числа заемщиков. Целевая переменная `SeriousDlqin2yrs` указывает, была ли у заемщика серьезная просрочка в последние два года.

## Признаки

Набор данных включает в себя следующие признаки:

*   `SeriousDlqin2yrs`:  Целевая переменная - Была ли у человека просрочка 90 дней и более (1) или нет (0).
*   `RevolvingUtilizationOfUnsecuredLines`:  Процент использования открытых кредитных линий.
*   `age`: Возраст заемщика в годах.
*   `NumberOfTime30-59DaysPastDueNotWorse`: Количество случаев просрочки платежа на 30-59 дней за последние 2 года (но не более серьезные просрочки).
*   `DebtRatio`: Отношение долга к доходу.
*   `MonthlyIncome`: Ежемесячный доход.
*   `NumberOfOpenCreditLinesAndLoans`: Количество открытых кредитных линий и кредитов.
*   `NumberOfTimes90DaysLate`: Количество случаев просрочки платежа на 90 дней и более.
*   `NumberRealEstateLoansOrLines`: Количество кредитов на недвижимость и кредитных линий.
*   `NumberOfTime60-89DaysPastDueNotWorse`: Количество случаев просрочки платежа на 60-89 дней за последние 2 года (но не более серьезные просрочки).
*   `NumberOfDependents`: Количество иждивенцев.
*   **Созданные признаки:** (Перечислите созданные вами новые признаки, например, `IncomePerPerson`, `AgeGroup`, `PastDueCount` и т.д.)

## Реализованные модели

Были реализованы и оценены следующие модели машинного обучения:

*   Логистическая регрессия
*   Случайный лес (Random Forest)
*   XGBoost
*   CatBoost
*   LightGBM

Для оптимизации производительности моделей была выполнена настройка гиперпараметров с использованием GridSearchCV и RandomizedSearchCV. Для борьбы с дисбалансом классов в наборе данных использовался метод SMOTE (Synthetic Minority Over-sampling Technique).

## Ключевые этапы проекта

1.  **Исследовательский анализ данных (EDA):**  Изучение данных, визуализация и получение первоначальных выводов.
2.  **Предобработка данных:** Обработка пропущенных значений, работа с выбросами, масштабирование признаков.
3.  **Инженерия признаков:** Создание новых признаков для повышения точности моделей.
4.  **Обучение и оценка моделей:** Обучение и оценка различных моделей классификации с использованием кросс-валидации и соответствующих метрик.
5.  **Настройка гиперпараметров:** Оптимизация параметров моделей для достижения наилучшей производительности.
6.  **Выбор модели:** Выбор лучшей модели на основе метрик оценки (в основном ROC AUC).
7.  **Генерация файла submission:** Создание файла submission в требуемом формате для Kaggle или аналогичных платформ.

## Используемые библиотеки

*   **pandas:** Манипуляция и анализ данных.
*   **numpy:** Численные вычисления.
*   **matplotlib & seaborn:** Визуализация данных.
*   **scikit-learn (sklearn):** Алгоритмы машинного обучения, оценка моделей, предобработка данных.
*   **imblearn:**  Работа с несбалансированными наборами данных (SMOTE).
*   **xgboost:**  Алгоритм градиентного бустинга.
*   **catboost:** Алгоритм градиентного бустинга.
*   **lightgbm:** Алгоритм градиентного бустинга.
*   **optuna (опционально):**  Для байесовской оптимизации гиперпараметров (если использовалось).

## Файлы репозитория

*   `GiveMeSomeCredit-training.csv`: Обучающий набор данных.
*   `GiveMeSomeCredit-testing.csv`: Тестовый набор данных.
*   `main.ipynb`: Jupyter Notebook, содержащий код проекта и анализ. (например, `CreditRiskPrediction.ipynb`)
*   `submission.csv`:  Пример файла submission, сгенерированный лучшей моделью.
*   `README.en.md`: README файл на английском языке (этот файл).
*   `README.ru.md`: README файл на русском языке.

## Как запустить

1.  **Клонируйте репозиторий**
2.  **Установите необходимые библиотеки:** (Рекомендуется использовать виртуальное окружение)
    ```bash
    pip install pandas numpy matplotlib seaborn scikit-learn imblearn xgboost catboost lightgbm optuna
    ```
3.  **Запустите Jupyter Notebook:**
    ```bash
    jupyter notebook main.ipynb
    ```
    Последовательно выполните ячейки ноутбука, чтобы воспроизвести анализ, обучение моделей и генерацию файла submission.

## Результаты

Лучшая модель достигла значения ROC AUC 0.85162 на валидационном/тестовом наборе данных.

Для получения подробных результатов и анализа, пожалуйста, обратитесь к Jupyter Notebook.

## Дальнейшие улучшения

*   **Продвинутая инженерия признаков:** Исследуйте более сложные взаимодействия признаков и признаки, специфичные для предметной области.
*   **Ансамблевые методы:**  Экспериментируйте с ансамблевыми методами, такими как стекинг или блендинг, чтобы объединить предсказания нескольких моделей.
*   **Оптимизация гиперпараметров:**  Используйте более продвинутые методы оптимизации гиперпараметров, такие как байесовская оптимизация, для потенциально лучших параметров моделей.
*   **Настройка порога классификации:** Оптимизируйте порог классификации для балансировки precision и recall в зависимости от конкретных бизнес-потребностей.
*   **Анализ ошибок:** Проведите подробный анализ ошибок, чтобы понять слабые стороны модели и области для улучшения.
